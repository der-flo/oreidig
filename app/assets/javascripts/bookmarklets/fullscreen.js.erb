/*
TODO: Combine with popup.js.erb
      A simple require at a specific position does not work, because requires
      only work at the beginning of a file.
TODO: Use CoffeeScript?
*/
(
  function(){
    location.href='<%= save_bookmark_url %>' +
                  '?url='    + encodeURIComponent(window.location.href) +
                  '&title=' + encodeURIComponent(document.title) +
                  '&notes=' + encodeURIComponent(''+
                                (window.getSelection ? 
                                  window.getSelection():
                                  document.getSelection ? 
                                    document.getSelection():
                                    document.selection.createRange().text)
                              )
  }
)()
